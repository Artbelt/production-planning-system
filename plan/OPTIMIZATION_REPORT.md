# üöÄ –û—Ç—á–µ—Ç –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ main.php

## –î–∞—Ç–∞: 2025-11-10

## –ü—Ä–æ–±–ª–µ–º—ã, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ:

### 1. ‚ùå N+1 –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞—è–≤–æ–∫
**–õ–æ–∫–∞—Ü–∏—è:** main.php, —Å—Ç—Ä–æ–∫–∏ 851-883

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö SQL-–∑–∞–ø—Ä–æ—Å–∞
- –ü—Ä–∏ 50 –∑–∞—è–≤–∫–∞—Ö = 100+ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–ª–æ—Å—å –ª–∏–Ω–µ–π–Ω–æ —Å —Ä–æ—Å—Ç–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞—è–≤–æ–∫

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –æ–¥–∏–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JOIN-–∑–∞–ø—Ä–æ—Å
SELECT 
    o.order_number,
    o.workshop,
    SUM(o.count) as total_planned,
    COALESCE(mp.total_produced, 0) as total_produced
FROM orders o
LEFT JOIN (
    SELECT name_of_order, SUM(count_of_filters) as total_produced
    FROM manufactured_production
    GROUP BY name_of_order
) mp ON o.order_number = mp.name_of_order
WHERE o.workshop = ? AND COALESCE(o.hide, 0) != 1
GROUP BY o.order_number, o.workshop
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å ~100+ –¥–æ 1!

---

### 2. ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
**–õ–æ–∫–∞—Ü–∏—è:** tools/tools.php

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§—É–Ω–∫—Ü–∏—è `show_ads()` —Å–æ–∑–¥–∞–≤–∞–ª–∞ –Ω–æ–≤–æ–µ PDO –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ
- –§—É–Ω–∫—Ü–∏—è `load_filters_into_select()` —Å–æ–∑–¥–∞–≤–∞–ª–∞ –Ω–æ–≤–æ–µ MySQLi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –í–∏–¥–∂–µ—Ç –∑–∞–¥–∞—á —Å–æ–∑–¥–∞–≤–∞–ª –æ—Ç–¥–µ–ª—å–Ω–æ–µ PDO –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `show_ads()` (60 —Å–µ–∫—É–Ω–¥)
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `load_filters_into_select()` (5 –º–∏–Ω—É—Ç)
- –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç PDO –∫ MySQLi –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î!

---

### 3. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
**–õ–æ–∫–∞—Ü–∏—è:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö plan_u5

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ JOIN –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã:

#### –¢–∞–±–ª–∏—Ü–∞ `orders`:
```sql
-- –ò–Ω–¥–µ–∫—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ü–µ—Ö—É
CREATE INDEX idx_orders_workshop_hide ON orders(workshop, hide);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
CREATE INDEX idx_orders_order_number ON orders(order_number);

-- –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
CREATE INDEX idx_orders_workshop_hide_number ON orders(workshop, hide, order_number);
```

#### –¢–∞–±–ª–∏—Ü–∞ `manufactured_production`:
```sql
-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–≥–æ
CREATE INDEX idx_manufactured_name_of_order ON manufactured_production(name_of_order);
CREATE INDEX idx_manufactured_order_count ON manufactured_production(name_of_order, count_of_filters);
```

#### –¢–∞–±–ª–∏—Ü–∞ `ads`:
```sql
-- –ò–Ω–¥–µ–∫—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
CREATE INDEX idx_ads_expires_at ON ads(expires_at);
```

#### –¢–∞–±–ª–∏—Ü–∞ `tasks`:
```sql
-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ –∑–∞–¥–∞—á –º–∞—Å—Ç–µ—Ä–æ–≤
CREATE INDEX idx_tasks_assigned_status_dept ON tasks(assigned_to, status, department);
CREATE INDEX idx_tasks_priority_due_date ON tasks(priority, due_date);
```

#### –¢–∞–±–ª–∏—Ü–∞ `panel_filter_structure` (–±–∞–∑–∞ plan):
```sql
CREATE INDEX idx_panel_filter ON panel_filter_structure(filter);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 5-10 —Ä–∞–∑!

---

### 4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§—É–Ω–∫—Ü–∏—è `show_ads()`:**
- –ö—ç—à –Ω–∞ 60 —Å–µ–∫—É–Ω–¥
- –û–±—ä—è–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è, –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–§—É–Ω–∫—Ü–∏—è `load_filters_into_select()`:**
- –ö—ç—à –Ω–∞ 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫—É–Ω–¥)
- –°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å—Ç–∞–±–∏–ª–µ–Ω, —Ä–µ–¥–∫–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
- –î–æ–±–∞–≤–ª–µ–Ω LIMIT 5000 –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ!

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **100+ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **5-10 —Å–µ–∫—É–Ω–¥** –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ (–ø—Ä–∏ 50 –∑–∞—è–≤–∫–∞—Ö)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **~10-15 SQL-–∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **0.5-2 —Å–µ–∫—É–Ω–¥—ã** –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
- –ú–∏–Ω–∏–º—É–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞

### –û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: **5-10x –±—ã—Å—Ç—Ä–µ–µ!** üöÄ

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ main.php:
```php
$start_time = microtime(true);
```

–ò –≤ –∫–æ–Ω–µ—Ü –ø–µ—Ä–µ–¥ `</body>`:
```php
$end_time = microtime(true);
$execution_time = $end_time - $start_time;
echo "<!-- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: " . round($execution_time, 3) . " —Å–µ–∫ -->";
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ MySQL
–í —Ñ–∞–π–ª–µ `my.ini` (C:\xampp\mysql\bin\my.ini) –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```ini
innodb_buffer_pool_size = 256M  # –£–≤–µ–ª–∏—á—å—Ç–µ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫—ç—à–∞
query_cache_size = 32M          # –ö—ç—à –∑–∞–ø—Ä–æ—Å–æ–≤
query_cache_type = 1            # –í–∫–ª—é—á–µ–Ω
```

### 3. PHP OpCache
–í `php.ini` —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω OpCache:
```ini
opcache.enable=1
opcache.memory_consumption=128
opcache.max_accelerated_files=10000
opcache.revalidate_freq=2
```

### 4. –î–∞–ª—å–Ω–µ–π—à–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Ajax –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–∂–µ—Ç–æ–≤ (–∑–∞–¥–∞—á–∏, –æ–±—ä—è–≤–ª–µ–Ω–∏—è)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis/Memcached –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Pagination –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞—è–≤–æ–∫
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫ (N+1 ‚Üí 1 –∑–∞–ø—Ä–æ—Å)
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ show_ads()
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ load_filters_into_select()
4. ‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (prepared statements)
6. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (htmlspecialchars –¥–ª—è –≤—ã–≤–æ–¥–∞)

---

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:

1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Del)
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É main.php
3. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Network
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
5. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É Console –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ main.php —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!**

–ï—Å–ª–∏ —É –≤–∞—Å –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ MySQL (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É CPU/RAM)
- –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ PHP (C:\xampp\php\logs\php_error_log)
- Slow Query Log –≤ MySQL

---

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:** 10.11.2025
**–ê–≤—Ç–æ—Ä:** AI Assistant

